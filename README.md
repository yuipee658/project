# project
# Документация к проекту: Прогнозирование цен на квартиры в Москве

---

## 1. Обзор проекта

Данный проект направлен на создание модели машинного обучения для прогнозирования цены на квартиры в Москве. Используется датасет с Kaggle: **[Prices of Moscow Apartments](https://www.kaggle.com/datasets/ivan314sh/prices-of-moscow-apartments)**.

### **Цели проекта:**
- Провести разведочный анализ данных.
- Обработать пропущенные значения.
- Подготовить признаки для моделирования.
- Обучить модели регрессии (LinearRegression).
- Оценить качество модели.

---

##  2. Структура проекта

Проект реализован в виде Jupyter-ноутбука `flats_prediction.ipynb`, содержащего следующие разделы:

1. **Установка библиотек**
2. **Импорт библиотек**
3. **Загрузка датасета**
4. **Исследование данных**
5. **Обработка пропущенных значений**
6. **Кодирование категориальных признаков**
7. **Исследование данных и визуализация**
8. **Подготовка данных для моделирования**
9. **Обучение и оценка моделей**

---

##  3. Используемые библиотеки

- `pandas` – работа с табличными данными
- `numpy` – численные операции
- `matplotlib` – построение графиков
- `seaborn` – визуализация данных
- `scikit-learn` – модели машинного обучения и метрики
- `catboost` – градиентный бустинг на деревьях
- `kagglehub` – загрузка датасета с Kaggle

---

##  4. Описание данных

Датасет содержит информацию о квартирах в Москве.  
Структура данных (13 столбцов):

| Название              | Тип данных | Описание |
|-----------------------|------------|----------|
| `price`               | float64    | Цена квартиры |
| `min_to_metro`        | float64    | Время до метро (мин) |
| `region_of_moscow`    | object     | Округ Москвы |
| `total_area`          | float64    | Общая площадь (м²) |
| `living_area`         | float64    | Жилая площадь (м²) |
| `floor`               | float64    | Этаж |
| `number_of_floors`    | float64    | Количество этажей в доме |
| `construction_year`   | float64    | Год постройки |
| `is_new`              | float64    | Новая ли квартира (0/1) |
| `is_apartments`       | float64    | Апартаменты ли (0/1) |
| `ceiling_height`      | float64    | Высота потолков (м) |
| `number_of_rooms`     | float64    | Количество комнат |
| `link`                | object     | Ссылка на объявление |

---

##  5. Предобработка данных

### **5.1. Обработка пропущенных значений:**
- Для числовых признаков пропуски заполнены **медианой**.
- Для категориального признака `region_of_moscow` пропуски заполнены **модой**.

### **5.2. Кодирование категориальных признаков:**
- Признак `region_of_moscow` преобразован через **One-Hot Encoding**.
- Признаки `is_new` и `is_apartments` оставлены в исходном виде (бинарные).

### **5.3. Удаление ненужных столбцов:**
- Удалены `region_of_moscow` и `link`.

---

##  6. Исследование данных (EDA)

### **6.1. Статистики:**
- Проверены распределения категориальных признаков.
- Построена тепловая карта корреляций для числовых признаков.

### **6.2. Визуализация:**
- Использованы `seaborn` и `matplotlib` для анализа связей между признаками.

---

##  7. Моделирование

### **7.1. Подготовка данных:**
- Признаки и целевая переменная (`price`) разделены на обучающую и тестовую выборки (80/20).
- Применена стандартизация числовых признаков.

### **7.2. Модели:**
1. **LinearRegression** – базовая линейная модель.
2. **CatBoostRegressor** – градиентный бустинг с поддержкой категориальных признаков.

### **7.3. Метрики оценки:**
- **MAE** (Mean Absolute Error)
- **MSE** (Mean Squared Error)
- **R²** (Коэффициент детерминации)

---

##  8. Результаты

В конце ноутбука представлены:
- Прогнозы модели на тестовой выборке.
- Значения метрик для каждой модели.
- Сравнение качества моделей.

---

##  9. Как запустить проект

### **Требования:**
- Python 3.8+
- Jupyter Notebook

### **Установка зависимостей:**
```bash
pip install pandas numpy matplotlib seaborn scikit-learn catboost kagglehub
```

### **Запуск:**
1. Скачать ноутбук `flats_prediction.ipynb`.
2. Запустить ячейки по порядку.

---

##  10. Возможные улучшения

1. **Feature Engineering** – создание новых признаков (например, цена за м²).
2. **Подбор гиперпараметров** для CatBoost.
3. **Ансамблирование моделей**.
4. **Учет географических данных** (координаты, удалённость от центра).
5. **Визуализация важности признаков**.

---

##  11. Ссылки

- [Датасет на Kaggle](https://www.kaggle.com/datasets/ivan314sh/prices-of-moscow-apartments)
- [Документация CatBoost](https://catboost.ai/docs/)
- [Scikit-learn documentation](https://scikit-learn.org/stable/)

---

##  Автор

Проект выполнен в рамках обучения машинному обучению.  
Используется открытый датасет и библиотеки Python.
